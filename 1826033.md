# 七日课 大作业：实现超分

经过这几天的学习，相信大家对GAN已经有了一定的了解了，也在前面的作业中体验过GAN的一些应用了。那现在大家是不是想要升级一下难度，自己动手来训练一个模型呢？

需要自己动手训练的大作业来啦，大作业内容为基于PaddleGAN中的超分模型，实现卡通画超分。


## 安装PaddleGAN

PaddleGAN的安装目前支持Clone GitHub和Gitee两种方式：


```python
# 安装ppgan
# 当前目录在: /home/aistudio/, 这个目录也是左边文件和文件夹所在的目录
# 克隆最新的PaddleGAN仓库到当前目录
# !git clone https://github.com/PaddlePaddle/PaddleGAN.git
# 如果从github下载慢可以从gitee clone：
!git clone https://gitee.com/paddlepaddle/PaddleGAN.git
# 安装Paddle GAN
%cd PaddleGAN/
!pip install -v -e .
```

    [K     |████████████████████████████████| 4.4MB 13.4MB/s eta 0:00:01

### 数据准备
我们为大家准备了处理好的超分数据集[卡通画超分数据集](https://aistudio.baidu.com/aistudio/datasetdetail/80790)


```python
# 回到/home/aistudio/下
%cd /home/aistudio
# 解压数据
!unzip -q data/data80790/animeSR.zip -d data/
# 将解压后的数据链接到` /home/aistudio/PaddleGAN/data `目录下
!mv data/animeSR PaddleGAN/data/
```

    /home/aistudio
    replace data/animeSR/test_X4/Anime_407.jpg? [y]es, [n]o, [A]ll, [N]one, [r]ename: ^C
    mv: cannot move 'data/animeSR' to 'PaddleGAN/data/animeSR': Directory not empty



### 数据集的组成形式
```
    PaddleGAN
      ├── data
          ├── animeSR
                ├── train
                ├── train_X4
                ├── test
                └── test_X4
  ```

训练数据集包括400张卡通画，其中``` train ```中是高分辨率图像，``` train_X4 ```中是对应的4倍缩小的低分辨率图像。测试数据集包括20张卡通画，其中``` test ```中是高分辨率图像，``` test_X4 ```中是对应的4倍缩小的低分辨率图像。

### 数据可视化


```python
import os
import cv2
import numpy as np
import matplotlib.pyplot as plt
# 训练数据统计
train_names = os.listdir('./PaddleGAN/data/animeSR/train')
print(f'训练集数据量: {len(train_names)}')

# 测试数据统计
test_names = os.listdir('./PaddleGAN/data/animeSR/test')
print(f'测试集数据量: {len(test_names)}')

# 训练数据可视化
img = cv2.imread('PaddleGAN/data/animeSR/train/Anime_239.jpg')
img = img[:,:,::-1]
plt.figure()
plt.imshow(img)
plt.show()
```

    训练集数据量: 400
    测试集数据量: 20



![png](output_7_1.png)


### 选择超分模型

PaddleGAN中提供的超分模型包括RealSR, ESRGAN, LESRCNN, DRN等，详情可见[超分模型](https://github.com/PaddlePaddle/PaddleGAN/blob/develop/docs/zh_CN/tutorials/super_resolution.md)。

接下来以ESRGAN为例进行演示。

### 修改配置文件
 所有模型的配置文件均在``` /home/aistudio/PaddleGAN/configs ```目录下。
 
 找到你需要的模型的配置文件，修改模型参数，一般修改迭代次数，num_workers，batch_size以及数据集路径。有能力的同学也可以尝试修改其他参数，或者基于现有模型进行二次开发，模型代码在``` /home/aistudio/PaddleGAN/ppgan/models ```目录下。
 
 以ESRGAN为例，这里将将配置文件``esrgan_psnr_x4_div2k.yaml``中的
 
 参数``total_iters``改为50000
 
 参数``dataset：train：num_workers``改为12
 
 参数``dataset：train：batch_size``改为48
 
 参数``dataset：train：gt_folder``改为data/animeSR/train
 
 参数``dataset：train：lq_folder``改为data/animeSR/train_X4
 
 参数``dataset：test：gt_folder``改为data/animeSR/test
 
 参数``dataset：test：lq_folder``改为data/animeSR/test_X4
 

### 训练模型
以ESRGAN为例，运行以下代码训练ESRGAN模型。

如果希望使用其他模型训练，可以修改配置文件名字。


```python
%cd /home/aistudio/PaddleGAN/
!python -u tools/main.py --config-file configs/esrgan_psnr_x4_div2k.yaml
```

    [04/20 15:29:18] ppgan.engine.trainer INFO: Metric ssim: 0.7601

### 测试模型
以ESRGAN为例，模型训练好后，运行以下代码测试ESRGAN模型。

其中``/home/aistudio/pretrained_model/ESRGAN_PSNR_50000_weight.pdparams``是刚才ESRGAN训练的模型参数，同学们需要换成自己的模型参数。

如果希望使用其他模型测试，可以修改配置文件名字。


```python
%cd /home/aistudio/PaddleGAN/
!python tools/main.py --config-file configs/esrgan_psnr_x4_div2k.yaml --evaluate-only --load /home/aistudio/pretrained_model/ESRGAN_PSNR_50000_weight.pdparams
```

    /home/aistudio/PaddleGAN
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
      import imp
    [04/20 15:29:47] ppgan INFO: Configs: {'total_iters': 50000, 'output_dir': 'output_dir/esrgan_psnr_x4_div2k-2021-04-20-15-29', 'min_max': (0.0, 1.0), 'model': {'name': 'BaseSRModel', 'generator': {'name': 'RRDBNet', 'in_nc': 3, 'out_nc': 3, 'nf': 64, 'nb': 23}, 'pixel_criterion': {'name': 'L1Loss'}}, 'dataset': {'train': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/train', 'lq_folder': 'data/animeSR/train_X4', 'num_workers': 4, 'batch_size': 16, 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'SRPairedRandomCrop', 'gt_patch_size': 128, 'scale': 4, 'keys': ['image', 'image']}, {'name': 'PairedRandomHorizontalFlip', 'keys': ['image', 'image']}, {'name': 'PairedRandomVerticalFlip', 'keys': ['image', 'image']}, {'name': 'PairedRandomTransposeHW', 'keys': ['image', 'image']}, {'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [255.0, 255.0, 255.0], 'keys': ['image', 'image']}]}]}, 'test': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/test', 'lq_folder': 'data/animeSR/test_X4', 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [255.0, 255.0, 255.0], 'keys': ['image', 'image']}]}]}}, 'lr_scheduler': {'name': 'CosineAnnealingRestartLR', 'learning_rate': 0.0002, 'periods': [250000, 250000, 250000, 250000], 'restart_weights': [1, 1, 1, 1], 'eta_min': 1e-07}, 'optimizer': {'name': 'Adam', 'net_names': ['generator'], 'beta1': 0.9, 'beta2': 0.99}, 'validate': {'interval': 5000, 'save_img': False, 'metrics': {'psnr': {'name': 'PSNR', 'crop_border': 4, 'test_y_channel': True}, 'ssim': {'name': 'SSIM', 'crop_border': 4, 'test_y_channel': True}}}, 'log_config': {'interval': 10, 'visiual_interval': 500}, 'snapshot_config': {'interval': 5000}, 'is_train': False, 'timestamp': '-2021-04-20-15-29'}
    W0420 15:29:47.852444 27047 device_context.cc:362] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
    W0420 15:29:47.857383 27047 device_context.cc:372] device: 0, cuDNN Version: 7.6.
    [04/20 15:29:54] ppgan.engine.trainer INFO: Loaded pretrained weight for net generator
    [04/20 15:30:03] ppgan.engine.trainer INFO: Test iter: [0/20]
    [04/20 15:30:30] ppgan.engine.trainer INFO: Test iter: [10/20]
    [04/20 15:30:48] ppgan.engine.trainer INFO: Metric psnr: 25.4782
    [04/20 15:30:48] ppgan.engine.trainer INFO: Metric ssim: 0.7608


以ESRGAN为例，这里将将配置文件``esrgan_x4_div2k.yaml``中的
 
 参数``total_iters``改为20000
 
 参数``dataset：train：num_workers``改为4
 
 参数``dataset：train：batch_size``改为16
 
 参数``dataset：train：gt_folder``改为data/animeSR/train
 
 参数``dataset：train：lq_folder``改为data/animeSR/train_X4
 
 参数``dataset：test：gt_folder``改为data/animeSR/test
 
 参数``dataset：test：lq_folder``改为data/animeSR/test_X4
 
 将/models/criterions/prerceptual_loss.py中的PerceptualLoss类中的url pretrained='https://paddlegan.bj.bcebos.com/model/vgg19.pdparams'，其中mdel修改为models


```python
%cd /home/aistudio/PaddleGAN/
!python -u tools/main.py --config-file configs/esrgan_x4_div2k.yaml
```

    /home/aistudio/PaddleGAN
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
      import imp
    [04/20 16:32:00] ppgan INFO: Configs: {'total_iters': 20000, 'output_dir': 'output_dir/esrgan_x4_div2k-2021-04-20-16-32', 'min_max': (0.0, 1.0), 'model': {'name': 'ESRGAN', 'generator': {'name': 'RRDBNet', 'in_nc': 3, 'out_nc': 3, 'nf': 64, 'nb': 23}, 'discriminator': {'name': 'VGGDiscriminator128', 'in_channels': 3, 'num_feat': 64}, 'pixel_criterion': {'name': 'L1Loss', 'loss_weight': 0.01}, 'perceptual_criterion': {'name': 'PerceptualLoss', 'layer_weights': {'34': 1.0}, 'perceptual_weight': 1.0, 'style_weight': 0.0, 'norm_img': False}, 'gan_criterion': {'name': 'GANLoss', 'gan_mode': 'vanilla', 'loss_weight': 0.005}}, 'dataset': {'train': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/train', 'lq_folder': 'data/animeSR/train_X4', 'num_workers': 4, 'batch_size': 16, 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'SRPairedRandomCrop', 'gt_patch_size': 128, 'scale': 4, 'keys': ['image', 'image']}, {'name': 'PairedRandomHorizontalFlip', 'keys': ['image', 'image']}, {'name': 'PairedRandomVerticalFlip', 'keys': ['image', 'image']}, {'name': 'PairedRandomTransposeHW', 'keys': ['image', 'image']}, {'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [255.0, 255.0, 255.0], 'keys': ['image', 'image']}]}]}, 'test': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/test', 'lq_folder': 'data/animeSR/test_X4', 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [255.0, 255.0, 255.0], 'keys': ['image', 'image']}]}]}}, 'lr_scheduler': {'name': 'MultiStepDecay', 'learning_rate': 0.0001, 'milestones': [50000, 100000, 200000, 300000], 'gamma': 0.5}, 'optimizer': {'optimG': {'name': 'Adam', 'net_names': ['generator'], 'weight_decay': 0.0, 'beta1': 0.9, 'beta2': 0.99}, 'optimD': {'name': 'Adam', 'net_names': ['discriminator'], 'weight_decay': 0.0, 'beta1': 0.9, 'beta2': 0.99}}, 'validate': {'interval': 5000, 'save_img': False, 'metrics': {'psnr': {'name': 'PSNR', 'crop_border': 4, 'test_y_channel': False}, 'ssim': {'name': 'SSIM', 'crop_border': 4, 'test_y_channel': False}}}, 'log_config': {'interval': 100, 'visiual_interval': 500}, 'snapshot_config': {'interval': 1000}, 'is_train': True, 'timestamp': '-2021-04-20-16-32'}
    W0420 16:32:00.996613 27041 device_context.cc:362] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
    W0420 16:32:01.002171 27041 device_context.cc:372] device: 0, cuDNN Version: 7.6.
    [04/20 16:32:06] ppgan INFO: Found /home/aistudio/.cache/ppgan/vgg19.pdparams
    PerceptualVGG loaded pretrained weight.
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/nn/layer/norm.py:648: UserWarning: When training, we now always track global mean and variance.
      "When training, we now always track global mean and variance.")
    [04/20 16:33:10] ppgan.engine.trainer INFO: Iter: 100/20000 lr: 1.000e-04 loss_pix: 0.034 loss_percep: 13.027 l_g_gan: 0.075 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 6.736 out_d_fake: -8.187 batch_cost: 0.57437 sec reader_cost: 0.07991 sec ips: 1.74103 images/s eta: 3:10:29
    [04/20 16:34:07] ppgan.engine.trainer INFO: Iter: 200/20000 lr: 1.000e-04 loss_pix: 0.017 loss_percep: 3.371 l_g_gan: 0.079 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 5.477 out_d_fake: -10.345 batch_cost: 0.57619 sec reader_cost: 0.08995 sec ips: 1.73555 images/s eta: 3:10:07
    [04/20 16:35:02] ppgan.engine.trainer INFO: Iter: 300/20000 lr: 1.000e-04 loss_pix: 0.016 loss_percep: 3.072 l_g_gan: 0.087 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 7.853 out_d_fake: -9.452 batch_cost: 0.54597 sec reader_cost: 0.07511 sec ips: 1.83160 images/s eta: 2:59:15
    [04/20 16:35:59] ppgan.engine.trainer INFO: Iter: 400/20000 lr: 1.000e-04 loss_pix: 0.014 loss_percep: 2.963 l_g_gan: 0.074 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 5.861 out_d_fake: -8.932 batch_cost: 0.57333 sec reader_cost: 0.08026 sec ips: 1.74419 images/s eta: 3:07:16
    [04/20 16:36:58] ppgan.engine.trainer INFO: Iter: 500/20000 lr: 1.000e-04 loss_pix: 0.017 loss_percep: 2.500 l_g_gan: 0.088 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 8.047 out_d_fake: -9.499 batch_cost: 0.58892 sec reader_cost: 0.08132 sec ips: 1.69801 images/s eta: 3:11:23
    [04/20 16:38:00] ppgan.engine.trainer INFO: Iter: 600/20000 lr: 1.000e-04 loss_pix: 0.012 loss_percep: 2.284 l_g_gan: 0.072 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 6.763 out_d_fake: -7.682 batch_cost: 0.62261 sec reader_cost: 0.08666 sec ips: 1.60614 images/s eta: 3:21:18
    [04/20 16:39:00] ppgan.engine.trainer INFO: Iter: 700/20000 lr: 1.000e-04 loss_pix: 0.014 loss_percep: 2.261 l_g_gan: 0.091 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 9.046 out_d_fake: -9.071 batch_cost: 0.59511 sec reader_cost: 0.07838 sec ips: 1.68035 images/s eta: 3:11:25
    [04/20 16:39:57] ppgan.engine.trainer INFO: Iter: 800/20000 lr: 1.000e-04 loss_pix: 0.012 loss_percep: 2.296 l_g_gan: 0.081 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 8.372 out_d_fake: -7.764 batch_cost: 0.57298 sec reader_cost: 0.07977 sec ips: 1.74527 images/s eta: 3:03:20
    [04/20 16:40:53] ppgan.engine.trainer INFO: Iter: 900/20000 lr: 1.000e-04 loss_pix: 0.013 loss_percep: 2.490 l_g_gan: 0.106 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 8.999 out_d_fake: -12.122 batch_cost: 0.55623 sec reader_cost: 0.07537 sec ips: 1.79783 images/s eta: 2:57:03
    [04/20 16:41:47] ppgan.engine.trainer INFO: Iter: 1000/20000 lr: 1.000e-04 loss_pix: 0.011 loss_percep: 2.169 l_g_gan: 0.099 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 10.417 out_d_fake: -9.371 batch_cost: 0.54167 sec reader_cost: 0.07428 sec ips: 1.84615 images/s eta: 2:51:31
    [04/20 16:42:48] ppgan.engine.trainer INFO: Iter: 1100/20000 lr: 1.000e-04 loss_pix: 0.010 loss_percep: 2.108 l_g_gan: 0.088 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 7.723 out_d_fake: -9.787 batch_cost: 0.54811 sec reader_cost: 0.07898 sec ips: 1.82446 images/s eta: 2:52:38
    [04/20 16:43:43] ppgan.engine.trainer INFO: Iter: 1200/20000 lr: 1.000e-04 loss_pix: 0.010 loss_percep: 2.098 l_g_gan: 0.104 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 10.671 out_d_fake: -10.204 batch_cost: 0.55558 sec reader_cost: 0.08564 sec ips: 1.79993 images/s eta: 2:54:04
    [04/20 16:44:39] ppgan.engine.trainer INFO: Iter: 1300/20000 lr: 1.000e-04 loss_pix: 0.010 loss_percep: 2.183 l_g_gan: 0.113 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 11.125 out_d_fake: -11.534 batch_cost: 0.55298 sec reader_cost: 0.08323 sec ips: 1.80840 images/s eta: 2:52:20
    [04/20 16:45:35] ppgan.engine.trainer INFO: Iter: 1400/20000 lr: 1.000e-04 loss_pix: 0.009 loss_percep: 2.264 l_g_gan: 0.101 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 6.325 out_d_fake: -13.870 batch_cost: 0.55789 sec reader_cost: 0.08729 sec ips: 1.79247 images/s eta: 2:52:56
    [04/20 16:46:32] ppgan.engine.trainer INFO: Iter: 1500/20000 lr: 1.000e-04 loss_pix: 0.008 loss_percep: 2.227 l_g_gan: 0.121 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 9.612 out_d_fake: -14.640 batch_cost: 0.57362 sec reader_cost: 0.08612 sec ips: 1.74330 images/s eta: 2:56:51
    [04/20 16:47:28] ppgan.engine.trainer INFO: Iter: 1600/20000 lr: 1.000e-04 loss_pix: 0.006 loss_percep: 2.140 l_g_gan: 0.104 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 10.225 out_d_fake: -10.589 batch_cost: 0.55918 sec reader_cost: 0.07932 sec ips: 1.78832 images/s eta: 2:51:28
    [04/20 16:48:31] ppgan.engine.trainer INFO: Iter: 1700/20000 lr: 1.000e-04 loss_pix: 0.007 loss_percep: 2.232 l_g_gan: 0.140 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 15.557 out_d_fake: -12.475 batch_cost: 0.62703 sec reader_cost: 0.09545 sec ips: 1.59482 images/s eta: 3:11:14
    [04/20 16:49:36] ppgan.engine.trainer INFO: Iter: 1800/20000 lr: 1.000e-04 loss_pix: 0.006 loss_percep: 2.447 l_g_gan: 0.141 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 8.507 out_d_fake: -19.677 batch_cost: 0.65532 sec reader_cost: 0.10282 sec ips: 1.52597 images/s eta: 3:18:46
    [04/20 16:50:43] ppgan.engine.trainer INFO: Iter: 1900/20000 lr: 1.000e-04 loss_pix: 0.005 loss_percep: 2.358 l_g_gan: 0.092 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 34.258 out_d_fake: 15.890 batch_cost: 0.66714 sec reader_cost: 0.08784 sec ips: 1.49893 images/s eta: 3:21:14
    [04/20 16:51:42] ppgan.engine.trainer INFO: Iter: 2000/20000 lr: 1.000e-04 loss_pix: 0.004 loss_percep: 2.209 l_g_gan: 0.096 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 39.694 out_d_fake: 20.411 batch_cost: 0.58772 sec reader_cost: 0.09415 sec ips: 1.70148 images/s eta: 2:56:18
    [04/20 16:52:44] ppgan.engine.trainer INFO: Iter: 2100/20000 lr: 1.000e-04 loss_pix: 0.004 loss_percep: 2.325 l_g_gan: 0.059 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 13.129 out_d_fake: 1.374 batch_cost: 0.56257 sec reader_cost: 0.07915 sec ips: 1.77757 images/s eta: 2:47:49
    [04/20 16:53:49] ppgan.engine.trainer INFO: Iter: 2200/20000 lr: 1.000e-04 loss_pix: 0.004 loss_percep: 2.102 l_g_gan: 0.062 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 24.634 out_d_fake: 12.314 batch_cost: 0.65477 sec reader_cost: 0.09118 sec ips: 1.52727 images/s eta: 3:14:14
    [04/20 16:54:45] ppgan.engine.trainer INFO: Iter: 2300/20000 lr: 1.000e-04 loss_pix: 0.003 loss_percep: 2.059 l_g_gan: 0.056 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 17.467 out_d_fake: 6.186 batch_cost: 0.55695 sec reader_cost: 0.07922 sec ips: 1.79549 images/s eta: 2:44:17
    [04/20 16:55:41] ppgan.engine.trainer INFO: Iter: 2400/20000 lr: 1.000e-04 loss_pix: 0.003 loss_percep: 2.183 l_g_gan: 0.066 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 21.460 out_d_fake: 8.334 batch_cost: 0.55764 sec reader_cost: 0.07731 sec ips: 1.79326 images/s eta: 2:43:33
    [04/20 16:56:41] ppgan.engine.trainer INFO: Iter: 2500/20000 lr: 1.000e-04 loss_pix: 0.002 loss_percep: 1.905 l_g_gan: 0.043 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 14.300 out_d_fake: 5.774 batch_cost: 0.59507 sec reader_cost: 0.09402 sec ips: 1.68046 images/s eta: 2:53:33
    [04/20 16:57:41] ppgan.engine.trainer INFO: Iter: 2600/20000 lr: 1.000e-04 loss_pix: 0.003 loss_percep: 2.148 l_g_gan: 0.068 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 19.449 out_d_fake: 5.768 batch_cost: 0.60430 sec reader_cost: 0.08342 sec ips: 1.65480 images/s eta: 2:55:14
    [04/20 16:58:40] ppgan.engine.trainer INFO: Iter: 2700/20000 lr: 1.000e-04 loss_pix: 0.002 loss_percep: 1.878 l_g_gan: 0.064 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 21.852 out_d_fake: 8.962 batch_cost: 0.58763 sec reader_cost: 0.08552 sec ips: 1.70175 images/s eta: 2:49:25
    [04/20 16:59:34] ppgan.engine.trainer INFO: Iter: 2800/20000 lr: 1.000e-04 loss_pix: 0.002 loss_percep: 1.979 l_g_gan: 0.069 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 28.019 out_d_fake: 14.128 batch_cost: 0.54518 sec reader_cost: 0.08110 sec ips: 1.83425 images/s eta: 2:36:16
    [04/20 17:00:31] ppgan.engine.trainer INFO: Iter: 2900/20000 lr: 1.000e-04 loss_pix: 0.002 loss_percep: 2.079 l_g_gan: 0.065 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 30.697 out_d_fake: 17.758 batch_cost: 0.56453 sec reader_cost: 0.07899 sec ips: 1.77140 images/s eta: 2:40:52
    [04/20 17:01:27] ppgan.engine.trainer INFO: Iter: 3000/20000 lr: 1.000e-04 loss_pix: 0.002 loss_percep: 2.060 l_g_gan: 0.053 l_d_real: 0.001 l_d_fake: 0.131 out_d_real: 20.344 out_d_fake: 9.909 batch_cost: 0.55919 sec reader_cost: 0.07685 sec ips: 1.78829 images/s eta: 2:38:25
    [04/20 17:02:27] ppgan.engine.trainer INFO: Iter: 3100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.282 l_g_gan: 0.062 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 30.187 out_d_fake: 17.865 batch_cost: 0.54558 sec reader_cost: 0.07263 sec ips: 1.83290 images/s eta: 2:33:39
    [04/20 17:03:23] ppgan.engine.trainer INFO: Iter: 3200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.901 l_g_gan: 0.047 l_d_real: 0.000 l_d_fake: 0.001 out_d_real: 18.778 out_d_fake: 9.476 batch_cost: 0.55654 sec reader_cost: 0.08146 sec ips: 1.79682 images/s eta: 2:35:49
    [04/20 17:04:19] ppgan.engine.trainer INFO: Iter: 3300/20000 lr: 1.000e-04 loss_pix: 0.002 loss_percep: 2.010 l_g_gan: 0.074 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 24.623 out_d_fake: 9.848 batch_cost: 0.56251 sec reader_cost: 0.07539 sec ips: 1.77774 images/s eta: 2:36:33
    [04/20 17:05:19] ppgan.engine.trainer INFO: Iter: 3400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.902 l_g_gan: 0.066 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 29.036 out_d_fake: 15.744 batch_cost: 0.59880 sec reader_cost: 0.08280 sec ips: 1.67002 images/s eta: 2:45:39
    [04/20 17:06:14] ppgan.engine.trainer INFO: Iter: 3500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.060 l_g_gan: 0.060 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 2.474 out_d_fake: -9.531 batch_cost: 0.55070 sec reader_cost: 0.07765 sec ips: 1.81588 images/s eta: 2:31:25
    [04/20 17:07:09] ppgan.engine.trainer INFO: Iter: 3600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.834 l_g_gan: 0.067 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 21.670 out_d_fake: 8.217 batch_cost: 0.54356 sec reader_cost: 0.07399 sec ips: 1.83971 images/s eta: 2:28:33
    [04/20 17:08:04] ppgan.engine.trainer INFO: Iter: 3700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.898 l_g_gan: 0.046 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 11.783 out_d_fake: 2.525 batch_cost: 0.54866 sec reader_cost: 0.07674 sec ips: 1.82261 images/s eta: 2:29:02
    [04/20 17:08:58] ppgan.engine.trainer INFO: Iter: 3800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.055 l_g_gan: 0.062 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 39.820 out_d_fake: 27.388 batch_cost: 0.54468 sec reader_cost: 0.07490 sec ips: 1.83594 images/s eta: 2:27:03
    [04/20 17:09:52] ppgan.engine.trainer INFO: Iter: 3900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.032 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 48.159 out_d_fake: 39.094 batch_cost: 0.53609 sec reader_cost: 0.07231 sec ips: 1.86537 images/s eta: 2:23:50
    [04/20 17:10:48] ppgan.engine.trainer INFO: Iter: 4000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.103 l_g_gan: 0.068 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 18.827 out_d_fake: 5.177 batch_cost: 0.56284 sec reader_cost: 0.07338 sec ips: 1.77671 images/s eta: 2:30:04
    [04/20 17:11:49] ppgan.engine.trainer INFO: Iter: 4100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.885 l_g_gan: 0.051 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 56.374 out_d_fake: 46.109 batch_cost: 0.55213 sec reader_cost: 0.07421 sec ips: 1.81117 images/s eta: 2:26:18
    [04/20 17:12:42] ppgan.engine.trainer INFO: Iter: 4200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.732 l_g_gan: 0.029 l_d_real: 0.004 l_d_fake: 0.006 out_d_real: 119.884 out_d_fake: 114.125 batch_cost: 0.52563 sec reader_cost: 0.07103 sec ips: 1.90246 images/s eta: 2:18:24
    [04/20 17:13:35] ppgan.engine.trainer INFO: Iter: 4300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.207 l_g_gan: 0.050 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 56.357 out_d_fake: 46.390 batch_cost: 0.53356 sec reader_cost: 0.07414 sec ips: 1.87422 images/s eta: 2:19:36
    [04/20 17:14:30] ppgan.engine.trainer INFO: Iter: 4400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.972 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 60.855 out_d_fake: 51.890 batch_cost: 0.54445 sec reader_cost: 0.07497 sec ips: 1.83672 images/s eta: 2:21:32
    [04/20 17:15:24] ppgan.engine.trainer INFO: Iter: 4500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.675 l_g_gan: 0.064 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 31.601 out_d_fake: 18.749 batch_cost: 0.53819 sec reader_cost: 0.06933 sec ips: 1.85809 images/s eta: 2:19:01
    [04/20 17:16:18] ppgan.engine.trainer INFO: Iter: 4600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.913 l_g_gan: 0.051 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 74.213 out_d_fake: 64.032 batch_cost: 0.54412 sec reader_cost: 0.06948 sec ips: 1.83784 images/s eta: 2:19:38
    [04/20 17:17:14] ppgan.engine.trainer INFO: Iter: 4700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.868 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 58.840 out_d_fake: 49.791 batch_cost: 0.55398 sec reader_cost: 0.08084 sec ips: 1.80514 images/s eta: 2:21:15
    [04/20 17:18:09] ppgan.engine.trainer INFO: Iter: 4800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.166 l_g_gan: 0.058 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 51.305 out_d_fake: 39.685 batch_cost: 0.55347 sec reader_cost: 0.07883 sec ips: 1.80678 images/s eta: 2:20:12
    [04/20 17:19:03] ppgan.engine.trainer INFO: Iter: 4900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.852 l_g_gan: 0.034 l_d_real: 0.003 l_d_fake: 0.005 out_d_real: 17.800 out_d_fake: 10.974 batch_cost: 0.53918 sec reader_cost: 0.07304 sec ips: 1.85465 images/s eta: 2:15:41
    [04/20 17:20:02] ppgan.engine.trainer INFO: Iter: 5000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.935 l_g_gan: 0.054 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 26.799 out_d_fake: 16.052 batch_cost: 0.58750 sec reader_cost: 0.07911 sec ips: 1.70212 images/s eta: 2:26:51
    [04/20 17:20:13] ppgan.engine.trainer INFO: Test iter: [0/20]
    [04/20 17:21:06] ppgan.engine.trainer INFO: Metric psnr: 19.6279
    [04/20 17:21:06] ppgan.engine.trainer INFO: Metric ssim: 0.4950
    [04/20 17:22:07] ppgan.engine.trainer INFO: Iter: 5100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.748 l_g_gan: 0.052 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 40.856 out_d_fake: 30.493 batch_cost: 0.55280 sec reader_cost: 0.08570 sec ips: 1.80897 images/s eta: 2:17:16
    [04/20 17:23:03] ppgan.engine.trainer INFO: Iter: 5200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.993 l_g_gan: 0.067 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 20.448 out_d_fake: 7.078 batch_cost: 0.55942 sec reader_cost: 0.09050 sec ips: 1.78757 images/s eta: 2:17:58
    [04/20 17:24:02] ppgan.engine.trainer INFO: Iter: 5300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.815 l_g_gan: 0.051 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 92.718 out_d_fake: 82.426 batch_cost: 0.59153 sec reader_cost: 0.09834 sec ips: 1.69053 images/s eta: 2:24:54
    [04/20 17:24:57] ppgan.engine.trainer INFO: Iter: 5400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.751 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 50.761 out_d_fake: 41.672 batch_cost: 0.55490 sec reader_cost: 0.08644 sec ips: 1.80213 images/s eta: 2:15:00
    [04/20 17:25:54] ppgan.engine.trainer INFO: Iter: 5500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.872 l_g_gan: 0.075 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 56.766 out_d_fake: 41.847 batch_cost: 0.56213 sec reader_cost: 0.08761 sec ips: 1.77896 images/s eta: 2:15:50
    [04/20 17:26:57] ppgan.engine.trainer INFO: Iter: 5600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.930 l_g_gan: 0.028 l_d_real: 0.006 l_d_fake: 0.015 out_d_real: -22.336 out_d_fake: -27.919 batch_cost: 0.63656 sec reader_cost: 0.09806 sec ips: 1.57095 images/s eta: 2:32:45
    [04/20 17:27:57] ppgan.engine.trainer INFO: Iter: 5700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.680 l_g_gan: 0.066 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 59.547 out_d_fake: 46.298 batch_cost: 0.59727 sec reader_cost: 0.09874 sec ips: 1.67429 images/s eta: 2:22:20
    [04/20 17:29:00] ppgan.engine.trainer INFO: Iter: 5800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.844 l_g_gan: 0.046 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 29.313 out_d_fake: 20.193 batch_cost: 0.63052 sec reader_cost: 0.10026 sec ips: 1.58600 images/s eta: 2:29:12
    [04/20 17:29:57] ppgan.engine.trainer INFO: Iter: 5900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.960 l_g_gan: 0.088 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 45.450 out_d_fake: 27.758 batch_cost: 0.56845 sec reader_cost: 0.09103 sec ips: 1.75917 images/s eta: 2:13:34
    [04/20 17:30:55] ppgan.engine.trainer INFO: Iter: 6000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.009 l_g_gan: 0.038 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 81.869 out_d_fake: 74.359 batch_cost: 0.57744 sec reader_cost: 0.09356 sec ips: 1.73178 images/s eta: 2:14:43
    [04/20 17:32:02] ppgan.engine.trainer INFO: Iter: 6100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.839 l_g_gan: 0.052 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 28.621 out_d_fake: 18.248 batch_cost: 0.59451 sec reader_cost: 0.10760 sec ips: 1.68205 images/s eta: 2:17:43
    [04/20 17:32:59] ppgan.engine.trainer INFO: Iter: 6200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.937 l_g_gan: 0.065 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 34.235 out_d_fake: 21.233 batch_cost: 0.56915 sec reader_cost: 0.09676 sec ips: 1.75701 images/s eta: 2:10:53
    [04/20 17:33:55] ppgan.engine.trainer INFO: Iter: 6300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.836 l_g_gan: 0.050 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 44.082 out_d_fake: 34.033 batch_cost: 0.56209 sec reader_cost: 0.09418 sec ips: 1.77906 images/s eta: 2:08:20
    [04/20 17:34:54] ppgan.engine.trainer INFO: Iter: 6400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.970 l_g_gan: 0.039 l_d_real: 0.016 l_d_fake: 0.003 out_d_real: 5.159 out_d_fake: -2.542 batch_cost: 0.58727 sec reader_cost: 0.09595 sec ips: 1.70280 images/s eta: 2:13:06
    [04/20 17:35:49] ppgan.engine.trainer INFO: Iter: 6500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.744 l_g_gan: 0.025 l_d_real: 0.005 l_d_fake: 0.004 out_d_real: -13.190 out_d_fake: -18.093 batch_cost: 0.55365 sec reader_cost: 0.08766 sec ips: 1.80620 images/s eta: 2:04:33
    [04/20 17:36:47] ppgan.engine.trainer INFO: Iter: 6600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.664 l_g_gan: 0.041 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 72.439 out_d_fake: 64.187 batch_cost: 0.57912 sec reader_cost: 0.08756 sec ips: 1.72676 images/s eta: 2:09:19
    [04/20 17:37:43] ppgan.engine.trainer INFO: Iter: 6700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.774 l_g_gan: 0.058 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 24.196 out_d_fake: 12.692 batch_cost: 0.56058 sec reader_cost: 0.09355 sec ips: 1.78388 images/s eta: 2:04:15
    [04/20 17:38:38] ppgan.engine.trainer INFO: Iter: 6800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.826 l_g_gan: 0.041 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 9.438 out_d_fake: 1.221 batch_cost: 0.54769 sec reader_cost: 0.08358 sec ips: 1.82585 images/s eta: 2:00:28
    [04/20 17:39:38] ppgan.engine.trainer INFO: Iter: 6900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.783 l_g_gan: 0.040 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: -31.930 out_d_fake: -40.006 batch_cost: 0.60439 sec reader_cost: 0.09769 sec ips: 1.65455 images/s eta: 2:11:56
    [04/20 17:40:40] ppgan.engine.trainer INFO: Iter: 7000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.788 l_g_gan: 0.041 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 0.060 out_d_fake: -8.233 batch_cost: 0.61295 sec reader_cost: 0.09888 sec ips: 1.63146 images/s eta: 2:12:47
    [04/20 17:41:42] ppgan.engine.trainer INFO: Iter: 7100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.937 l_g_gan: 0.038 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 54.896 out_d_fake: 47.240 batch_cost: 0.56417 sec reader_cost: 0.09587 sec ips: 1.77251 images/s eta: 2:01:17
    [04/20 17:42:38] ppgan.engine.trainer INFO: Iter: 7200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.857 l_g_gan: 0.043 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 82.560 out_d_fake: 73.928 batch_cost: 0.55633 sec reader_cost: 0.08613 sec ips: 1.79750 images/s eta: 1:58:40
    [04/20 17:43:36] ppgan.engine.trainer INFO: Iter: 7300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.765 l_g_gan: 0.047 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 46.634 out_d_fake: 37.264 batch_cost: 0.58323 sec reader_cost: 0.08687 sec ips: 1.71458 images/s eta: 2:03:26
    [04/20 17:44:36] ppgan.engine.trainer INFO: Iter: 7400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.094 l_g_gan: 0.056 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 59.212 out_d_fake: 47.988 batch_cost: 0.59924 sec reader_cost: 0.09419 sec ips: 1.66878 images/s eta: 2:05:49
    [04/20 17:45:34] ppgan.engine.trainer INFO: Iter: 7500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.598 l_g_gan: 0.041 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 71.288 out_d_fake: 63.056 batch_cost: 0.57723 sec reader_cost: 0.09881 sec ips: 1.73242 images/s eta: 2:00:14
    [04/20 17:46:30] ppgan.engine.trainer INFO: Iter: 7600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.819 l_g_gan: 0.021 l_d_real: 0.012 l_d_fake: 0.013 out_d_real: 24.200 out_d_fake: 20.026 batch_cost: 0.56345 sec reader_cost: 0.08628 sec ips: 1.77477 images/s eta: 1:56:26
    [04/20 17:47:30] ppgan.engine.trainer INFO: Iter: 7700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.765 l_g_gan: 0.067 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 92.618 out_d_fake: 79.274 batch_cost: 0.59767 sec reader_cost: 0.09257 sec ips: 1.67317 images/s eta: 2:02:30
    [04/20 17:48:27] ppgan.engine.trainer INFO: Iter: 7800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.745 l_g_gan: 0.042 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 152.254 out_d_fake: 143.929 batch_cost: 0.56894 sec reader_cost: 0.09104 sec ips: 1.75765 images/s eta: 1:55:40
    [04/20 17:49:24] ppgan.engine.trainer INFO: Iter: 7900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.064 l_g_gan: 0.047 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 201.809 out_d_fake: 192.424 batch_cost: 0.56738 sec reader_cost: 0.09643 sec ips: 1.76249 images/s eta: 1:54:24
    [04/20 17:50:23] ppgan.engine.trainer INFO: Iter: 8000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.854 l_g_gan: 0.039 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 95.002 out_d_fake: 87.182 batch_cost: 0.59113 sec reader_cost: 0.09996 sec ips: 1.69166 images/s eta: 1:58:13
    [04/20 17:51:26] ppgan.engine.trainer INFO: Iter: 8100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.946 l_g_gan: 0.046 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 74.702 out_d_fake: 65.598 batch_cost: 0.56515 sec reader_cost: 0.09796 sec ips: 1.76943 images/s eta: 1:52:04
    [04/20 17:52:24] ppgan.engine.trainer INFO: Iter: 8200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.795 l_g_gan: 0.015 l_d_real: 0.035 l_d_fake: 0.032 out_d_real: 103.194 out_d_fake: 100.322 batch_cost: 0.57752 sec reader_cost: 0.09166 sec ips: 1.73154 images/s eta: 1:53:34
    [04/20 17:53:23] ppgan.engine.trainer INFO: Iter: 8300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.842 l_g_gan: 0.043 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 209.333 out_d_fake: 200.713 batch_cost: 0.58679 sec reader_cost: 0.10190 sec ips: 1.70418 images/s eta: 1:54:24
    [04/20 17:54:18] ppgan.engine.trainer INFO: Iter: 8400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.867 l_g_gan: 0.075 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 216.651 out_d_fake: 201.602 batch_cost: 0.55437 sec reader_cost: 0.08233 sec ips: 1.80386 images/s eta: 1:47:10
    [04/20 17:55:14] ppgan.engine.trainer INFO: Iter: 8500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.581 l_g_gan: 0.022 l_d_real: 0.008 l_d_fake: 0.008 out_d_real: -18.437 out_d_fake: -22.818 batch_cost: 0.55591 sec reader_cost: 0.08814 sec ips: 1.79886 images/s eta: 1:46:32
    [04/20 17:56:10] ppgan.engine.trainer INFO: Iter: 8600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.626 l_g_gan: 0.050 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 42.481 out_d_fake: 32.558 batch_cost: 0.55571 sec reader_cost: 0.08392 sec ips: 1.79950 images/s eta: 1:45:34
    [04/20 17:57:06] ppgan.engine.trainer INFO: Iter: 8700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.897 l_g_gan: 0.056 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 75.947 out_d_fake: 64.738 batch_cost: 0.56228 sec reader_cost: 0.08769 sec ips: 1.77848 images/s eta: 1:45:53
    [04/20 17:58:03] ppgan.engine.trainer INFO: Iter: 8800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.884 l_g_gan: 0.051 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 84.856 out_d_fake: 74.572 batch_cost: 0.57006 sec reader_cost: 0.09131 sec ips: 1.75420 images/s eta: 1:46:24
    [04/20 17:59:00] ppgan.engine.trainer INFO: Iter: 8900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.845 l_g_gan: 0.063 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -43.221 out_d_fake: -55.901 batch_cost: 0.56543 sec reader_cost: 0.09014 sec ips: 1.76857 images/s eta: 1:44:35
    [04/20 17:59:55] ppgan.engine.trainer INFO: Iter: 9000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.823 l_g_gan: 0.044 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -15.484 out_d_fake: -24.249 batch_cost: 0.55319 sec reader_cost: 0.08591 sec ips: 1.80770 images/s eta: 1:41:24
    [04/20 18:00:57] ppgan.engine.trainer INFO: Iter: 9100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.810 l_g_gan: 0.075 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 104.314 out_d_fake: 89.396 batch_cost: 0.56105 sec reader_cost: 0.08628 sec ips: 1.78236 images/s eta: 1:41:54
    [04/20 18:01:53] ppgan.engine.trainer INFO: Iter: 9200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.794 l_g_gan: 0.044 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -33.261 out_d_fake: -41.974 batch_cost: 0.56043 sec reader_cost: 0.08967 sec ips: 1.78434 images/s eta: 1:40:52
    [04/20 18:02:52] ppgan.engine.trainer INFO: Iter: 9300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.733 l_g_gan: 0.048 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 131.622 out_d_fake: 122.077 batch_cost: 0.59498 sec reader_cost: 0.09256 sec ips: 1.68073 images/s eta: 1:46:05
    [04/20 18:03:53] ppgan.engine.trainer INFO: Iter: 9400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.829 l_g_gan: 0.085 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 244.119 out_d_fake: 227.201 batch_cost: 0.60437 sec reader_cost: 0.10049 sec ips: 1.65462 images/s eta: 1:46:45
    [04/20 18:04:49] ppgan.engine.trainer INFO: Iter: 9500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.665 l_g_gan: 0.052 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 130.465 out_d_fake: 120.057 batch_cost: 0.56327 sec reader_cost: 0.09207 sec ips: 1.77534 images/s eta: 1:38:33
    [04/20 18:05:45] ppgan.engine.trainer INFO: Iter: 9600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.923 l_g_gan: 0.040 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 121.390 out_d_fake: 113.362 batch_cost: 0.55945 sec reader_cost: 0.09016 sec ips: 1.78748 images/s eta: 1:36:57
    [04/20 18:06:42] ppgan.engine.trainer INFO: Iter: 9700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.617 l_g_gan: 0.033 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 119.807 out_d_fake: 113.291 batch_cost: 0.56564 sec reader_cost: 0.09579 sec ips: 1.76790 images/s eta: 1:37:05
    [04/20 18:07:44] ppgan.engine.trainer INFO: Iter: 9800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.888 l_g_gan: 0.054 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 120.528 out_d_fake: 109.729 batch_cost: 0.61661 sec reader_cost: 0.09386 sec ips: 1.62178 images/s eta: 1:44:48
    [04/20 18:08:42] ppgan.engine.trainer INFO: Iter: 9900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.996 l_g_gan: 0.073 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 95.431 out_d_fake: 80.895 batch_cost: 0.58131 sec reader_cost: 0.09816 sec ips: 1.72025 images/s eta: 1:37:50
    [04/20 18:09:38] ppgan.engine.trainer INFO: Iter: 10000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.665 l_g_gan: 0.068 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 187.908 out_d_fake: 174.212 batch_cost: 0.56103 sec reader_cost: 0.09206 sec ips: 1.78242 images/s eta: 1:33:29
    [04/20 18:09:49] ppgan.engine.trainer INFO: Test iter: [0/20]
    [04/20 18:10:42] ppgan.engine.trainer INFO: Metric psnr: 19.4997
    [04/20 18:10:42] ppgan.engine.trainer INFO: Metric ssim: 0.5185
    [04/20 18:11:45] ppgan.engine.trainer INFO: Iter: 10100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.882 l_g_gan: 0.069 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 206.520 out_d_fake: 192.701 batch_cost: 0.57854 sec reader_cost: 0.08984 sec ips: 1.72850 images/s eta: 1:35:26
    [04/20 18:12:42] ppgan.engine.trainer INFO: Iter: 10200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.027 l_g_gan: 0.064 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 87.722 out_d_fake: 74.985 batch_cost: 0.56733 sec reader_cost: 0.09619 sec ips: 1.76265 images/s eta: 1:32:39
    [04/20 18:13:38] ppgan.engine.trainer INFO: Iter: 10300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.915 l_g_gan: 0.052 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 87.654 out_d_fake: 77.246 batch_cost: 0.56190 sec reader_cost: 0.09694 sec ips: 1.77968 images/s eta: 1:30:49
    [04/20 18:14:34] ppgan.engine.trainer INFO: Iter: 10400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.963 l_g_gan: 0.086 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 42.093 out_d_fake: 24.850 batch_cost: 0.55591 sec reader_cost: 0.09120 sec ips: 1.79884 images/s eta: 1:28:56
    [04/20 18:15:32] ppgan.engine.trainer INFO: Iter: 10500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.931 l_g_gan: 0.048 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -3.354 out_d_fake: -12.952 batch_cost: 0.58004 sec reader_cost: 0.09712 sec ips: 1.72402 images/s eta: 1:31:49
    [04/20 18:16:29] ppgan.engine.trainer INFO: Iter: 10600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.825 l_g_gan: 0.047 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 39.130 out_d_fake: 29.706 batch_cost: 0.56603 sec reader_cost: 0.09733 sec ips: 1.76668 images/s eta: 1:28:40
    [04/20 18:17:25] ppgan.engine.trainer INFO: Iter: 10700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.862 l_g_gan: 0.040 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 55.401 out_d_fake: 47.372 batch_cost: 0.56359 sec reader_cost: 0.09701 sec ips: 1.77434 images/s eta: 1:27:20
    [04/20 18:18:25] ppgan.engine.trainer INFO: Iter: 10800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.068 l_g_gan: 0.074 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 45.866 out_d_fake: 31.009 batch_cost: 0.59941 sec reader_cost: 0.09241 sec ips: 1.66830 images/s eta: 1:31:53
    [04/20 18:19:27] ppgan.engine.trainer INFO: Iter: 10900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.004 l_g_gan: 0.030 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 75.010 out_d_fake: 69.026 batch_cost: 0.62115 sec reader_cost: 0.11012 sec ips: 1.60992 images/s eta: 1:34:11
    [04/20 18:20:27] ppgan.engine.trainer INFO: Iter: 11000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.594 l_g_gan: 0.062 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 53.191 out_d_fake: 40.840 batch_cost: 0.59413 sec reader_cost: 0.09631 sec ips: 1.68312 images/s eta: 1:29:06
    [04/20 18:21:32] ppgan.engine.trainer INFO: Iter: 11100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.852 l_g_gan: 0.033 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 57.772 out_d_fake: 51.148 batch_cost: 0.59471 sec reader_cost: 0.09514 sec ips: 1.68150 images/s eta: 1:28:12
    [04/20 18:22:30] ppgan.engine.trainer INFO: Iter: 11200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.662 l_g_gan: 0.066 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 91.081 out_d_fake: 77.793 batch_cost: 0.57786 sec reader_cost: 0.09072 sec ips: 1.73053 images/s eta: 1:24:44
    [04/20 18:23:26] ppgan.engine.trainer INFO: Iter: 11300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.943 l_g_gan: 0.089 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 107.932 out_d_fake: 90.130 batch_cost: 0.55780 sec reader_cost: 0.08854 sec ips: 1.79275 images/s eta: 1:20:52
    [04/20 18:24:27] ppgan.engine.trainer INFO: Iter: 11400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.857 l_g_gan: 0.041 l_d_real: 0.000 l_d_fake: 0.001 out_d_real: 156.218 out_d_fake: 148.091 batch_cost: 0.61005 sec reader_cost: 0.10587 sec ips: 1.63922 images/s eta: 1:27:25
    [04/20 18:25:22] ppgan.engine.trainer INFO: Iter: 11500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.798 l_g_gan: 0.067 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 99.664 out_d_fake: 86.305 batch_cost: 0.55622 sec reader_cost: 0.09011 sec ips: 1.79785 images/s eta: 1:18:47
    [04/20 18:26:22] ppgan.engine.trainer INFO: Iter: 11600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.754 l_g_gan: 0.039 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 15.011 out_d_fake: 7.255 batch_cost: 0.59643 sec reader_cost: 0.09533 sec ips: 1.67663 images/s eta: 1:23:29
    [04/20 18:27:19] ppgan.engine.trainer INFO: Iter: 11700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.841 l_g_gan: 0.033 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 103.134 out_d_fake: 96.526 batch_cost: 0.56973 sec reader_cost: 0.09842 sec ips: 1.75521 images/s eta: 1:18:48
    [04/20 18:28:17] ppgan.engine.trainer INFO: Iter: 11800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.802 l_g_gan: 0.089 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 186.329 out_d_fake: 168.545 batch_cost: 0.58249 sec reader_cost: 0.09424 sec ips: 1.71676 images/s eta: 1:19:35
    [04/20 18:29:16] ppgan.engine.trainer INFO: Iter: 11900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.794 l_g_gan: 0.039 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -16.165 out_d_fake: -24.055 batch_cost: 0.58955 sec reader_cost: 0.09557 sec ips: 1.69620 images/s eta: 1:19:34
    [04/20 18:30:15] ppgan.engine.trainer INFO: Iter: 12000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.631 l_g_gan: 0.068 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -10.452 out_d_fake: -23.982 batch_cost: 0.58816 sec reader_cost: 0.09353 sec ips: 1.70022 images/s eta: 1:18:24
    [04/20 18:31:17] ppgan.engine.trainer INFO: Iter: 12100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.663 l_g_gan: 0.042 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -20.843 out_d_fake: -29.302 batch_cost: 0.55955 sec reader_cost: 0.09042 sec ips: 1.78716 images/s eta: 1:13:39
    [04/20 18:32:19] ppgan.engine.trainer INFO: Iter: 12200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.872 l_g_gan: 0.107 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -7.406 out_d_fake: -28.841 batch_cost: 0.62135 sec reader_cost: 0.11300 sec ips: 1.60939 images/s eta: 1:20:45
    [04/20 18:33:15] ppgan.engine.trainer INFO: Iter: 12300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.777 l_g_gan: 0.036 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 43.117 out_d_fake: 36.008 batch_cost: 0.55905 sec reader_cost: 0.09120 sec ips: 1.78875 images/s eta: 1:11:44
    [04/20 18:34:14] ppgan.engine.trainer INFO: Iter: 12400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.697 l_g_gan: 0.037 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 97.324 out_d_fake: 89.931 batch_cost: 0.58978 sec reader_cost: 0.08798 sec ips: 1.69554 images/s eta: 1:14:41
    [04/20 18:35:08] ppgan.engine.trainer INFO: Iter: 12500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.697 l_g_gan: 0.040 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 93.391 out_d_fake: 85.473 batch_cost: 0.54561 sec reader_cost: 0.08509 sec ips: 1.83280 images/s eta: 1:08:11
    [04/20 18:36:03] ppgan.engine.trainer INFO: Iter: 12600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.011 l_g_gan: 0.071 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 106.432 out_d_fake: 92.188 batch_cost: 0.54292 sec reader_cost: 0.08268 sec ips: 1.84189 images/s eta: 1:06:57
    [04/20 18:37:03] ppgan.engine.trainer INFO: Iter: 12700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.664 l_g_gan: 0.009 l_d_real: 0.129 l_d_fake: 0.160 out_d_real: 210.638 out_d_fake: 209.219 batch_cost: 0.60100 sec reader_cost: 0.09775 sec ips: 1.66389 images/s eta: 1:13:06
    [04/20 18:38:08] ppgan.engine.trainer INFO: Iter: 12800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.848 l_g_gan: 0.033 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 207.931 out_d_fake: 201.419 batch_cost: 0.64682 sec reader_cost: 0.10958 sec ips: 1.54603 images/s eta: 1:17:36
    [04/20 18:39:04] ppgan.engine.trainer INFO: Iter: 12900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.869 l_g_gan: 0.039 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 51.454 out_d_fake: 43.710 batch_cost: 0.55979 sec reader_cost: 0.09273 sec ips: 1.78639 images/s eta: 1:06:13
    [04/20 18:39:57] ppgan.engine.trainer INFO: Iter: 13000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.824 l_g_gan: 0.042 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 67.596 out_d_fake: 59.208 batch_cost: 0.53712 sec reader_cost: 0.08110 sec ips: 1.86177 images/s eta: 1:02:39
    [04/20 18:40:57] ppgan.engine.trainer INFO: Iter: 13100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.843 l_g_gan: 0.054 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 44.402 out_d_fake: 33.579 batch_cost: 0.54350 sec reader_cost: 0.08515 sec ips: 1.83993 images/s eta: 1:02:29
    [04/20 18:42:00] ppgan.engine.trainer INFO: Iter: 13200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.830 l_g_gan: 0.103 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 172.928 out_d_fake: 152.421 batch_cost: 0.62227 sec reader_cost: 0.11040 sec ips: 1.60702 images/s eta: 1:10:30
    [04/20 18:42:59] ppgan.engine.trainer INFO: Iter: 13300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.959 l_g_gan: 0.023 l_d_real: 0.007 l_d_fake: 0.008 out_d_real: -69.275 out_d_fake: -73.956 batch_cost: 0.59175 sec reader_cost: 0.10435 sec ips: 1.68990 images/s eta: 1:06:04
    [04/20 18:43:56] ppgan.engine.trainer INFO: Iter: 13400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.836 l_g_gan: 0.070 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -37.992 out_d_fake: -52.028 batch_cost: 0.56955 sec reader_cost: 0.09193 sec ips: 1.75577 images/s eta: 1:02:38
    [04/20 18:44:50] ppgan.engine.trainer INFO: Iter: 13500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.943 l_g_gan: 0.070 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -43.667 out_d_fake: -57.688 batch_cost: 0.53888 sec reader_cost: 0.08113 sec ips: 1.85570 images/s eta: 0:58:22
    [04/20 18:45:44] ppgan.engine.trainer INFO: Iter: 13600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.594 l_g_gan: 0.107 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -56.063 out_d_fake: -77.550 batch_cost: 0.54516 sec reader_cost: 0.08201 sec ips: 1.83432 images/s eta: 0:58:08
    [04/20 18:46:39] ppgan.engine.trainer INFO: Iter: 13700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.606 l_g_gan: 0.027 l_d_real: 0.012 l_d_fake: 0.042 out_d_real: 228.002 out_d_fake: 222.713 batch_cost: 0.54803 sec reader_cost: 0.08622 sec ips: 1.82472 images/s eta: 0:57:32
    [04/20 18:47:38] ppgan.engine.trainer INFO: Iter: 13800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.981 l_g_gan: 0.082 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 220.897 out_d_fake: 204.474 batch_cost: 0.59212 sec reader_cost: 0.09780 sec ips: 1.68884 images/s eta: 1:01:10
    [04/20 18:48:34] ppgan.engine.trainer INFO: Iter: 13900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.839 l_g_gan: 0.036 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 270.459 out_d_fake: 263.269 batch_cost: 0.55858 sec reader_cost: 0.09185 sec ips: 1.79026 images/s eta: 0:56:46
    [04/20 18:49:30] ppgan.engine.trainer INFO: Iter: 14000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.887 l_g_gan: 0.177 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 109.134 out_d_fake: 73.648 batch_cost: 0.55766 sec reader_cost: 0.09243 sec ips: 1.79322 images/s eta: 0:55:45
    [04/20 18:50:32] ppgan.engine.trainer INFO: Iter: 14100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.897 l_g_gan: 0.080 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 107.883 out_d_fake: 91.939 batch_cost: 0.56280 sec reader_cost: 0.09226 sec ips: 1.77682 images/s eta: 0:55:19
    [04/20 18:51:28] ppgan.engine.trainer INFO: Iter: 14200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.810 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 105.747 out_d_fake: 96.777 batch_cost: 0.55804 sec reader_cost: 0.09214 sec ips: 1.79199 images/s eta: 0:53:56
    [04/20 18:52:24] ppgan.engine.trainer INFO: Iter: 14300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.852 l_g_gan: 0.048 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 40.517 out_d_fake: 30.992 batch_cost: 0.56243 sec reader_cost: 0.08735 sec ips: 1.77801 images/s eta: 0:53:25
    [04/20 18:53:21] ppgan.engine.trainer INFO: Iter: 14400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.120 l_g_gan: 0.034 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: -8.977 out_d_fake: -15.730 batch_cost: 0.57246 sec reader_cost: 0.08959 sec ips: 1.74686 images/s eta: 0:53:25
    [04/20 18:54:28] ppgan.engine.trainer INFO: Iter: 14500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.797 l_g_gan: 0.058 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -50.099 out_d_fake: -61.766 batch_cost: 0.66114 sec reader_cost: 0.13225 sec ips: 1.51253 images/s eta: 1:00:35
    [04/20 18:55:25] ppgan.engine.trainer INFO: Iter: 14600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.865 l_g_gan: 0.074 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -50.329 out_d_fake: -65.207 batch_cost: 0.57761 sec reader_cost: 0.09817 sec ips: 1.73127 images/s eta: 0:51:58
    [04/20 18:56:21] ppgan.engine.trainer INFO: Iter: 14700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.738 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 7.451 out_d_fake: -1.541 batch_cost: 0.55366 sec reader_cost: 0.08473 sec ips: 1.80616 images/s eta: 0:48:53
    [04/20 18:57:18] ppgan.engine.trainer INFO: Iter: 14800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.945 l_g_gan: 0.076 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 36.015 out_d_fake: 20.885 batch_cost: 0.57397 sec reader_cost: 0.10245 sec ips: 1.74224 images/s eta: 0:49:44
    [04/20 18:58:16] ppgan.engine.trainer INFO: Iter: 14900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.700 l_g_gan: 0.087 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 138.943 out_d_fake: 121.585 batch_cost: 0.58289 sec reader_cost: 0.09372 sec ips: 1.71560 images/s eta: 0:49:32
    [04/20 18:59:13] ppgan.engine.trainer INFO: Iter: 15000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.738 l_g_gan: 0.050 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -23.306 out_d_fake: -33.326 batch_cost: 0.56786 sec reader_cost: 0.09644 sec ips: 1.76101 images/s eta: 0:47:18
    [04/20 18:59:24] ppgan.engine.trainer INFO: Test iter: [0/20]
    [04/20 19:00:21] ppgan.engine.trainer INFO: Metric psnr: 19.9520
    [04/20 19:00:21] ppgan.engine.trainer INFO: Metric ssim: 0.5689
    [04/20 19:01:24] ppgan.engine.trainer INFO: Iter: 15100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.838 l_g_gan: 0.046 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -57.237 out_d_fake: -66.466 batch_cost: 0.56914 sec reader_cost: 0.09038 sec ips: 1.75703 images/s eta: 0:46:28
    [04/20 19:02:23] ppgan.engine.trainer INFO: Iter: 15200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.732 l_g_gan: 0.015 l_d_real: 0.031 l_d_fake: 0.031 out_d_real: -70.791 out_d_fake: -73.684 batch_cost: 0.58901 sec reader_cost: 0.09582 sec ips: 1.69778 images/s eta: 0:47:06
    [04/20 19:03:20] ppgan.engine.trainer INFO: Iter: 15300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.745 l_g_gan: 0.086 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: -44.706 out_d_fake: -61.880 batch_cost: 0.57299 sec reader_cost: 0.09174 sec ips: 1.74522 images/s eta: 0:44:52
    [04/20 19:04:16] ppgan.engine.trainer INFO: Iter: 15400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.897 l_g_gan: 0.064 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 27.219 out_d_fake: 14.352 batch_cost: 0.55829 sec reader_cost: 0.09130 sec ips: 1.79119 images/s eta: 0:42:47
    [04/20 19:05:12] ppgan.engine.trainer INFO: Iter: 15500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.697 l_g_gan: 0.071 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 33.633 out_d_fake: 19.505 batch_cost: 0.55738 sec reader_cost: 0.09019 sec ips: 1.79409 images/s eta: 0:41:47
    [04/20 19:06:08] ppgan.engine.trainer INFO: Iter: 15600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.854 l_g_gan: 0.039 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 45.450 out_d_fake: 37.582 batch_cost: 0.56466 sec reader_cost: 0.08685 sec ips: 1.77096 images/s eta: 0:41:23
    [04/20 19:07:06] ppgan.engine.trainer INFO: Iter: 15700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.811 l_g_gan: 0.063 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 15.396 out_d_fake: 2.877 batch_cost: 0.57709 sec reader_cost: 0.09041 sec ips: 1.73283 images/s eta: 0:41:20
    [04/20 19:08:04] ppgan.engine.trainer INFO: Iter: 15800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.704 l_g_gan: 0.061 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 24.410 out_d_fake: 12.270 batch_cost: 0.58342 sec reader_cost: 0.10115 sec ips: 1.71402 images/s eta: 0:40:49
    [04/20 19:09:05] ppgan.engine.trainer INFO: Iter: 15900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.713 l_g_gan: 0.056 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 67.479 out_d_fake: 56.347 batch_cost: 0.60545 sec reader_cost: 0.09790 sec ips: 1.65167 images/s eta: 0:41:21
    [04/20 19:10:06] ppgan.engine.trainer INFO: Iter: 16000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.961 l_g_gan: 0.064 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 223.196 out_d_fake: 210.457 batch_cost: 0.61203 sec reader_cost: 0.09786 sec ips: 1.63390 images/s eta: 0:40:47
    [04/20 19:11:10] ppgan.engine.trainer INFO: Iter: 16100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.936 l_g_gan: 0.065 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 242.637 out_d_fake: 229.731 batch_cost: 0.58460 sec reader_cost: 0.10503 sec ips: 1.71056 images/s eta: 0:37:59
    [04/20 19:12:09] ppgan.engine.trainer INFO: Iter: 16200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.668 l_g_gan: 0.051 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 91.584 out_d_fake: 81.293 batch_cost: 0.58676 sec reader_cost: 0.11382 sec ips: 1.70426 images/s eta: 0:37:09
    [04/20 19:13:06] ppgan.engine.trainer INFO: Iter: 16300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.041 l_g_gan: 0.079 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 145.970 out_d_fake: 130.197 batch_cost: 0.56460 sec reader_cost: 0.08862 sec ips: 1.77118 images/s eta: 0:34:48
    [04/20 19:14:02] ppgan.engine.trainer INFO: Iter: 16400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.702 l_g_gan: 0.024 l_d_real: 0.004 l_d_fake: 0.004 out_d_real: 160.454 out_d_fake: 155.606 batch_cost: 0.56178 sec reader_cost: 0.09479 sec ips: 1.78006 images/s eta: 0:33:41
    [04/20 19:14:58] ppgan.engine.trainer INFO: Iter: 16500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.116 l_g_gan: 0.083 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 217.230 out_d_fake: 200.661 batch_cost: 0.56091 sec reader_cost: 0.08815 sec ips: 1.78282 images/s eta: 0:32:42
    [04/20 19:15:53] ppgan.engine.trainer INFO: Iter: 16600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.657 l_g_gan: 0.060 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 146.465 out_d_fake: 134.478 batch_cost: 0.54915 sec reader_cost: 0.08947 sec ips: 1.82100 images/s eta: 0:31:06
    [04/20 19:16:48] ppgan.engine.trainer INFO: Iter: 16700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.763 l_g_gan: 0.030 l_d_real: 0.002 l_d_fake: 0.002 out_d_real: 30.208 out_d_fake: 24.246 batch_cost: 0.55330 sec reader_cost: 0.08761 sec ips: 1.80733 images/s eta: 0:30:25
    [04/20 19:17:46] ppgan.engine.trainer INFO: Iter: 16800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.784 l_g_gan: 0.063 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 49.279 out_d_fake: 36.584 batch_cost: 0.58171 sec reader_cost: 0.09668 sec ips: 1.71907 images/s eta: 0:31:00
    [04/20 19:18:42] ppgan.engine.trainer INFO: Iter: 16900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.828 l_g_gan: 0.087 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 33.204 out_d_fake: 15.881 batch_cost: 0.55934 sec reader_cost: 0.08666 sec ips: 1.78782 images/s eta: 0:28:53
    [04/20 19:19:41] ppgan.engine.trainer INFO: Iter: 17000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.019 l_g_gan: 0.080 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 41.336 out_d_fake: 25.349 batch_cost: 0.58759 sec reader_cost: 0.09995 sec ips: 1.70187 images/s eta: 0:29:22
    [04/20 19:20:42] ppgan.engine.trainer INFO: Iter: 17100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.844 l_g_gan: 0.048 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 130.837 out_d_fake: 121.261 batch_cost: 0.55693 sec reader_cost: 0.08733 sec ips: 1.79554 images/s eta: 0:26:54
    [04/20 19:21:38] ppgan.engine.trainer INFO: Iter: 17200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.875 l_g_gan: 0.062 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 122.037 out_d_fake: 109.579 batch_cost: 0.55610 sec reader_cost: 0.08482 sec ips: 1.79823 images/s eta: 0:25:56
    [04/20 19:22:35] ppgan.engine.trainer INFO: Iter: 17300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.917 l_g_gan: 0.092 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 143.243 out_d_fake: 124.923 batch_cost: 0.56595 sec reader_cost: 0.09171 sec ips: 1.76693 images/s eta: 0:25:27
    [04/20 19:23:31] ppgan.engine.trainer INFO: Iter: 17400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.988 l_g_gan: 0.097 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 173.987 out_d_fake: 154.622 batch_cost: 0.55864 sec reader_cost: 0.08981 sec ips: 1.79008 images/s eta: 0:24:11
    [04/20 19:24:29] ppgan.engine.trainer INFO: Iter: 17500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.911 l_g_gan: 0.061 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 139.161 out_d_fake: 126.947 batch_cost: 0.58291 sec reader_cost: 0.09312 sec ips: 1.71552 images/s eta: 0:24:16
    [04/20 19:25:26] ppgan.engine.trainer INFO: Iter: 17600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.691 l_g_gan: 0.095 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 159.250 out_d_fake: 140.349 batch_cost: 0.56878 sec reader_cost: 0.09531 sec ips: 1.75816 images/s eta: 0:22:44
    [04/20 19:26:21] ppgan.engine.trainer INFO: Iter: 17700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.846 l_g_gan: 0.032 l_d_real: 0.001 l_d_fake: 0.001 out_d_real: 56.384 out_d_fake: 49.890 batch_cost: 0.55401 sec reader_cost: 0.08580 sec ips: 1.80504 images/s eta: 0:21:13
    [04/20 19:27:29] ppgan.engine.trainer INFO: Iter: 17800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.777 l_g_gan: 0.010 l_d_real: 0.078 l_d_fake: 0.074 out_d_real: 124.402 out_d_fake: 122.527 batch_cost: 0.67766 sec reader_cost: 0.12734 sec ips: 1.47567 images/s eta: 0:24:50
    [04/20 19:28:30] ppgan.engine.trainer INFO: Iter: 17900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.719 l_g_gan: 0.039 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 126.499 out_d_fake: 118.697 batch_cost: 0.60799 sec reader_cost: 0.11597 sec ips: 1.64475 images/s eta: 0:21:16
    [04/20 19:29:31] ppgan.engine.trainer INFO: Iter: 18000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.642 l_g_gan: 0.067 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 156.335 out_d_fake: 142.928 batch_cost: 0.60796 sec reader_cost: 0.10725 sec ips: 1.64484 images/s eta: 0:20:15
    [04/20 19:30:34] ppgan.engine.trainer INFO: Iter: 18100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.892 l_g_gan: 0.043 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 178.341 out_d_fake: 169.714 batch_cost: 0.56941 sec reader_cost: 0.09491 sec ips: 1.75620 images/s eta: 0:18:01
    [04/20 19:31:46] ppgan.engine.trainer INFO: Iter: 18200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.496 l_g_gan: 0.048 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 146.008 out_d_fake: 136.401 batch_cost: 0.72639 sec reader_cost: 0.13246 sec ips: 1.37667 images/s eta: 0:21:46
    [04/20 19:32:52] ppgan.engine.trainer INFO: Iter: 18300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.874 l_g_gan: 0.051 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 160.967 out_d_fake: 150.824 batch_cost: 0.65824 sec reader_cost: 0.16116 sec ips: 1.51920 images/s eta: 0:18:38
    [04/20 19:33:58] ppgan.engine.trainer INFO: Iter: 18400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.101 l_g_gan: 0.053 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 146.809 out_d_fake: 136.165 batch_cost: 0.66022 sec reader_cost: 0.11526 sec ips: 1.51464 images/s eta: 0:17:35
    [04/20 19:35:18] ppgan.engine.trainer INFO: Iter: 18500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 2.109 l_g_gan: 0.048 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 123.794 out_d_fake: 114.218 batch_cost: 0.79895 sec reader_cost: 0.17537 sec ips: 1.25164 images/s eta: 0:19:57
    [04/20 19:36:16] ppgan.engine.trainer INFO: Iter: 18600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.662 l_g_gan: 0.050 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 184.696 out_d_fake: 174.628 batch_cost: 0.57386 sec reader_cost: 0.09862 sec ips: 1.74258 images/s eta: 0:13:22
    [04/20 19:37:15] ppgan.engine.trainer INFO: Iter: 18700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.859 l_g_gan: 0.045 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 239.628 out_d_fake: 230.675 batch_cost: 0.59338 sec reader_cost: 0.09626 sec ips: 1.68526 images/s eta: 0:12:50
    [04/20 19:38:14] ppgan.engine.trainer INFO: Iter: 18800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.792 l_g_gan: 0.067 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 269.590 out_d_fake: 256.256 batch_cost: 0.58985 sec reader_cost: 0.10606 sec ips: 1.69534 images/s eta: 0:11:47
    [04/20 19:39:11] ppgan.engine.trainer INFO: Iter: 18900/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.842 l_g_gan: 0.027 l_d_real: 0.002 l_d_fake: 0.002 out_d_real: 251.429 out_d_fake: 246.065 batch_cost: 0.57176 sec reader_cost: 0.10095 sec ips: 1.74900 images/s eta: 0:10:28
    [04/20 19:40:10] ppgan.engine.trainer INFO: Iter: 19000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.872 l_g_gan: 0.073 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 138.753 out_d_fake: 124.221 batch_cost: 0.58985 sec reader_cost: 0.11188 sec ips: 1.69536 images/s eta: 0:09:49
    [04/20 19:41:13] ppgan.engine.trainer INFO: Iter: 19100/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.812 l_g_gan: 0.037 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 153.993 out_d_fake: 146.643 batch_cost: 0.57322 sec reader_cost: 0.10567 sec ips: 1.74454 images/s eta: 0:08:35
    [04/20 19:42:12] ppgan.engine.trainer INFO: Iter: 19200/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.706 l_g_gan: 0.058 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 250.925 out_d_fake: 239.408 batch_cost: 0.58734 sec reader_cost: 0.11182 sec ips: 1.70259 images/s eta: 0:07:49
    [04/20 19:43:10] ppgan.engine.trainer INFO: Iter: 19300/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.808 l_g_gan: 0.046 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 120.198 out_d_fake: 110.957 batch_cost: 0.58095 sec reader_cost: 0.09269 sec ips: 1.72131 images/s eta: 0:06:46
    [04/20 19:44:08] ppgan.engine.trainer INFO: Iter: 19400/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.649 l_g_gan: 0.015 l_d_real: 0.036 l_d_fake: 0.036 out_d_real: 44.478 out_d_fake: 41.623 batch_cost: 0.57755 sec reader_cost: 0.10668 sec ips: 1.73146 images/s eta: 0:05:45
    [04/20 19:45:06] ppgan.engine.trainer INFO: Iter: 19500/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.711 l_g_gan: 0.075 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 112.135 out_d_fake: 97.090 batch_cost: 0.57880 sec reader_cost: 0.10996 sec ips: 1.72773 images/s eta: 0:04:48
    [04/20 19:46:02] ppgan.engine.trainer INFO: Iter: 19600/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.786 l_g_gan: 0.072 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 106.848 out_d_fake: 92.525 batch_cost: 0.56358 sec reader_cost: 0.09620 sec ips: 1.77436 images/s eta: 0:03:44
    [04/20 19:46:59] ppgan.engine.trainer INFO: Iter: 19700/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.621 l_g_gan: 0.074 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 125.226 out_d_fake: 110.398 batch_cost: 0.56815 sec reader_cost: 0.10043 sec ips: 1.76009 images/s eta: 0:02:49
    [04/20 19:47:57] ppgan.engine.trainer INFO: Iter: 19800/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.861 l_g_gan: 0.046 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 150.922 out_d_fake: 141.784 batch_cost: 0.58333 sec reader_cost: 0.09148 sec ips: 1.71429 images/s eta: 0:01:56
    [04/20 19:49:51] ppgan.engine.trainer INFO: Iter: 20000/20000 lr: 1.000e-04 loss_pix: 0.001 loss_percep: 1.770 l_g_gan: 0.069 l_d_real: 0.000 l_d_fake: 0.000 out_d_real: 171.538 out_d_fake: 157.791 batch_cost: 0.56873 sec reader_cost: 0.09327 sec ips: 1.75831 images/s eta: 0:00:00
    [04/20 19:50:02] ppgan.engine.trainer INFO: Test iter: [0/20]
    [04/20 19:50:59] ppgan.engine.trainer INFO: Metric psnr: 19.3260
    [04/20 19:50:59] ppgan.engine.trainer INFO: Metric ssim: 0.5615


### 测试模型
以ESRGAN为例，模型训练好后，运行以下代码测试ESRGAN模型。

其中``/home/aistudio/pretrained_model/ESRGAN_50000_weight.pdparams``是刚才ESRGAN训练的模型参数




```python
%cd /home/aistudio/PaddleGAN/
!python tools/main.py --config-file configs/esrgan_psnr_x4_div2k.yaml --evaluate-only --load /home/aistudio/pretrained_model/ESRGAN_GAN_50000_weight.pdparams
```

    /home/aistudio/PaddleGAN
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
      import imp
    [04/20 19:53:03] ppgan INFO: Configs: {'total_iters': 50000, 'output_dir': 'output_dir/esrgan_psnr_x4_div2k-2021-04-20-19-53', 'min_max': (0.0, 1.0), 'model': {'name': 'BaseSRModel', 'generator': {'name': 'RRDBNet', 'in_nc': 3, 'out_nc': 3, 'nf': 64, 'nb': 23}, 'pixel_criterion': {'name': 'L1Loss'}}, 'dataset': {'train': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/train', 'lq_folder': 'data/animeSR/train_X4', 'num_workers': 4, 'batch_size': 16, 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'SRPairedRandomCrop', 'gt_patch_size': 128, 'scale': 4, 'keys': ['image', 'image']}, {'name': 'PairedRandomHorizontalFlip', 'keys': ['image', 'image']}, {'name': 'PairedRandomVerticalFlip', 'keys': ['image', 'image']}, {'name': 'PairedRandomTransposeHW', 'keys': ['image', 'image']}, {'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [255.0, 255.0, 255.0], 'keys': ['image', 'image']}]}]}, 'test': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/test', 'lq_folder': 'data/animeSR/test_X4', 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [255.0, 255.0, 255.0], 'keys': ['image', 'image']}]}]}}, 'lr_scheduler': {'name': 'CosineAnnealingRestartLR', 'learning_rate': 0.0002, 'periods': [250000, 250000, 250000, 250000], 'restart_weights': [1, 1, 1, 1], 'eta_min': 1e-07}, 'optimizer': {'name': 'Adam', 'net_names': ['generator'], 'beta1': 0.9, 'beta2': 0.99}, 'validate': {'interval': 5000, 'save_img': False, 'metrics': {'psnr': {'name': 'PSNR', 'crop_border': 4, 'test_y_channel': True}, 'ssim': {'name': 'SSIM', 'crop_border': 4, 'test_y_channel': True}}}, 'log_config': {'interval': 10, 'visiual_interval': 500}, 'snapshot_config': {'interval': 5000}, 'is_train': False, 'timestamp': '-2021-04-20-19-53'}
    W0420 19:53:03.021432 29522 device_context.cc:362] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
    W0420 19:53:03.026604 29522 device_context.cc:372] device: 0, cuDNN Version: 7.6.
    [04/20 19:53:10] ppgan.engine.trainer INFO: Loaded pretrained weight for net generator
    [04/20 19:53:21] ppgan.engine.trainer INFO: Test iter: [0/20]
    [04/20 19:53:50] ppgan.engine.trainer INFO: Test iter: [10/20]
    [04/20 19:54:09] ppgan.engine.trainer INFO: Metric psnr: 23.3055
    [04/20 19:54:09] ppgan.engine.trainer INFO: Metric ssim: 0.6802


以DRN为例，这里将将配置文件``drn_psnr_x4_div2k.yaml``中的
 
 参数``total_iters``改为5000
 
 参数``dataset：train：num_workers``改为1
 
 参数``dataset：train：batch_size``改为2
 
 参数``dataset：train：gt_folder``改为data/animeSR/train
 
 参数``dataset：train：lq_folder``改为data/animeSR/train_X4
 
 参数``dataset：test：gt_folder``改为data/animeSR/test
 
 参数``dataset：test：lq_folder``改为data/animeSR/test_X4


```python
%cd /home/aistudio/PaddleGAN/
!python -u tools/main.py --config-file configs/drn_psnr_x4_div2k.yaml
```

    /home/aistudio/PaddleGAN
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/setuptools/depends.py:2: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
      import imp
    [04/20 22:10:08] ppgan INFO: Configs: {'total_iters': 5000, 'output_dir': 'output_dir/drn_psnr_x4_div2k-2021-04-20-22-10', 'min_max': (0.0, 255.0), 'model': {'name': 'DRN', 'generator': {'name': 'DRNGenerator', 'scale': (2, 4), 'n_blocks': 30, 'n_feats': 16, 'n_colors': 3, 'rgb_range': 255, 'negval': 0.2}, 'pixel_criterion': {'name': 'L1Loss'}}, 'dataset': {'train': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/train', 'lq_folder': 'data/animeSR/train_X4', 'num_workers': 1, 'batch_size': 2, 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'output_keys': ['lq', 'lqx2', 'gt'], 'pipeline': [{'name': 'SRPairedRandomCrop', 'gt_patch_size': 384, 'scale': 4, 'scale_list': True, 'keys': ['image', 'image']}, {'name': 'PairedRandomHorizontalFlip', 'keys': ['image', 'image', 'image']}, {'name': 'PairedRandomVerticalFlip', 'keys': ['image', 'image', 'image']}, {'name': 'PairedRandomTransposeHW', 'keys': ['image', 'image', 'image']}, {'name': 'Transpose', 'keys': ['image', 'image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [1.0, 1.0, 1.0], 'keys': ['image', 'image', 'image']}]}]}, 'test': {'name': 'SRDataset', 'gt_folder': 'data/animeSR/test', 'lq_folder': 'data/animeSR/test_X4', 'scale': 4, 'preprocess': [{'name': 'LoadImageFromFile', 'key': 'lq'}, {'name': 'LoadImageFromFile', 'key': 'gt'}, {'name': 'Transforms', 'input_keys': ['lq', 'gt'], 'pipeline': [{'name': 'Transpose', 'keys': ['image', 'image']}, {'name': 'Normalize', 'mean': [0.0, 0.0, 0.0], 'std': [1.0, 1.0, 1.0], 'keys': ['image', 'image']}]}]}}, 'lr_scheduler': {'name': 'CosineAnnealingRestartLR', 'learning_rate': 0.0001, 'periods': [1000000], 'restart_weights': [1], 'eta_min': 1e-07}, 'optimizer': {'optimG': {'name': 'Adam', 'net_names': ['generator'], 'weight_decay': 0.0, 'beta1': 0.9, 'beta2': 0.999}, 'optimD': {'name': 'Adam', 'net_names': ['dual_model_0', 'dual_model_1'], 'weight_decay': 0.0, 'beta1': 0.9, 'beta2': 0.999}}, 'validate': {'interval': 5000, 'save_img': False, 'metrics': {'psnr': {'name': 'PSNR', 'crop_border': 4, 'test_y_channel': True}, 'ssim': {'name': 'SSIM', 'crop_border': 4, 'test_y_channel': True}}}, 'log_config': {'interval': 100, 'visiual_interval': 500}, 'snapshot_config': {'interval': 100}, 'is_train': True, 'timestamp': '-2021-04-20-22-10'}
    W0420 22:10:08.648085 11212 device_context.cc:362] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 11.0, Runtime API Version: 10.1
    W0420 22:10:08.652902 11212 device_context.cc:372] device: 0, cuDNN Version: 7.6.
    [04/20 22:11:25] ppgan.engine.trainer INFO: Iter: 200/5000 lr: 1.000e-04 loss_promary: 22.524 loss_dual: 17.623 loss_total: 40.147 batch_cost: 0.34799 sec reader_cost: 0.00543 sec ips: 2.87361 images/s eta: 0:27:50


### 实验结果展示及模型下载
这里使用ESRGAN模型训练了一个基于PSNR指标的预测模型和一个基于GAN的预测模型。

数值结果展示及模型下载

| 方法 | 数据集 | 迭代次数 | 训练时长 | PSNR | SSIM | 模型下载 |
|---|---|---|---|---|---|---|
| ESRGAN_PSNR  | 卡通画超分数据集 | 50000 | 13.5h | 25.4782 | 0.7608 |[ESRGAN_PSNR](./pretrained_model/ESRGAN_PSNR_50000_weight.pdparams)|
| ESRGAN_GAN  | 卡通画超分数据集 | 50000 | 11h | 21.4148 | 0.6176 |[ESRGAN_GAN](./pretrained_model/ESRGAN_GAN_50000_weight.pdparams)|

可视化
| 低分辨率 | ESRGAN_PSNR | ESRGAN_GAN | GT |
|---|---|---|---|
|![](./image/Anime_401_lq.png)|![](./image/Anime_401_psnr.png)|![](./image/Anime_401_gan.png)|![](./image/Anime_401_gt.png)|
|![](./image/Anime_407_lq.png)|![](./image/Anime_407_psnr.png)|![](./image/Anime_407_gan.png)|![](./image/Anime_407_gt.png)|




```python

```
